(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{240:function(t,s,a){"use strict";var n=function(){var t=0,s=document.createElement("div");function a(t){return s.appendChild(t.dom),t}function e(a){for(var n=0;n<s.children.length;n++)s.children[n].style.display=n===a?"block":"none";t=a}s.style.cssText="position:absolute;top:0;left:0;cursor:pointer;opacity:0.9;z-index:19",s.addEventListener("click",(function(a){a.preventDefault(),e(++t%s.children.length)}),!1);var r=(performance||Date).now(),p=r,o=0,c=a(new n.Panel("FPS","#0ff","#002")),l=a(new n.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var v=a(new n.Panel("MB","#f08","#201"));return e(0),{REVISION:16,dom:s,addPanel:a,showPanel:e,begin:function(){r=(performance||Date).now()},end:function(){o++;var t=(performance||Date).now();if(l.update(t-r,200),t>=p+1e3&&(c.update(1e3*o/(t-p),100),p=t,o=0,v)){var s=performance.memory;v.update(s.usedJSHeapSize/1048576,s.jsHeapSizeLimit/1048576)}return t},update:function(){r=this.end()},domElement:s,setMode:e}};n.Panel=function(t,s,a){var n=1/0,e=0,r=Math.round,p=r(window.devicePixelRatio||1),o=80*p,c=48*p,l=3*p,v=2*p,i=3*p,_=15*p,u=74*p,k=30*p,d=document.createElement("canvas");d.width=o,d.height=c,d.style.cssText="width:80px;height:48px";var m=d.getContext("2d");return m.font="bold "+9*p+"px Helvetica,Arial,sans-serif",m.textBaseline="top",m.fillStyle=a,m.fillRect(0,0,o,c),m.fillStyle=s,m.fillText(t,l,v),m.fillRect(i,_,u,k),m.fillStyle=a,m.globalAlpha=.9,m.fillRect(i,_,u,k),{dom:d,update:function(c,f){n=Math.min(n,c),e=Math.max(e,c),m.fillStyle=a,m.globalAlpha=1,m.fillRect(0,0,o,_),m.fillStyle=s,m.fillText(r(c)+" "+t+" ("+r(n)+"-"+r(e)+")",l,v),m.drawImage(d,i+p,_,u-p,k,i,_,u-p,k),m.fillRect(i+u-p,_,p,k),m.fillStyle=a,m.globalAlpha=.9,m.fillRect(i+u-p,_,p,r((1-c/f)*k))}}},s.a=n},241:function(t,s,a){"use strict";a.d(s,"f",(function(){return p})),a.d(s,"e",(function(){return o})),a.d(s,"c",(function(){return c})),a.d(s,"g",(function(){return l})),a.d(s,"d",(function(){return v})),a.d(s,"b",(function(){return i})),a.d(s,"h",(function(){return _})),a.d(s,"a",(function(){return u}));var n=a(240),e=a(239),r=a(243);function p(t,s){var a=void 0!==t&&t&&!isNaN(t)?parseInt(t):0,e=new n.a;return e.showPanel(a),s.appendChild(e.dom),e}function o(t,s){var a=void 0!==s&&s?s:{},n=new e.Vb(a);return n.shadowMap.enabled=!0,n.shadowMapSoft=!0,n.shadowMap.type=e.ib,n.setClearColor(new e.p(0)),n.setSize(t.clientWidth,t.clientHeight),n.shadowMap.enabled=!0,t.appendChild(n.domElement),n}function c(t,s){var a=void 0!==s?s:new e.Sb(-30,40,30),n=new e.jb(45,t.clientWidth/t.clientHeight,.1,1e3);return n.position.set(a.x,a.y,a.z),n.lookAt(new e.Sb(0,0,0)),n}function l(t,s){var a=new r.a(t,s.domElement);return a.rotateSpeed=1,a.zoomSpeed=1.2,a.panSpeed=.8,a.noZoom=!1,a.noPan=!1,a.staticMoving=!0,a.dynamicDampingFactor=.3,a.keys=[65,83,68],a}function v(t,s){var a=void 0!==s?s:new e.Sb(-10,30,40),n=new e.Gb(16777215);n.position.copy(a),n.shadow.mapSize.width=2048,n.shadow.mapSize.height=2048,n.shadow.camera.fov=15,n.castShadow=!0,n.decay=2,n.penumbra=.05,n.name="spotLight",t.add(n);var r=new e.b(3421236);r.name="ambientLight",t.add(r)}function i(t){var s=new e.lb(60,20,120,120),a=new e.Y({color:16777215}),n=new e.V(s,a);return n.receiveShadow=!0,n.rotation.x=-.5*Math.PI,n.position.x=15,n.position.y=0,n.position.z=0,t.add(n),n}function _(t,s){var a=t.children;a&&a.length>0?a.forEach((function(t){_(t,s)})):t instanceof e.V&&(t.material instanceof Array?t.material.forEach((function(t){t.color=new e.p(s(Math.random()).hex()),0===t.name.indexOf("building")&&(t.emissive=new e.p(4473924),t.transparent=!0,t.opacity=.8)})):(t.material.color=new e.p(s(Math.random()).hex()),0==t.material.name.indexOf("building")&&(t.material.emissive=new e.p(4473924),t.material.transparent=!0,t.material.opacity=.8)))}function u(t){var s=new e.Mb,a=new e.Y({map:s.load("/daodao-knowledge/textures/earth/Earth.png"),normalMap:s.load("/daodao-knowledge/textures/earth/EarthNormal.png"),specularMap:s.load("/daodao-knowledge/textures/earth/EarthSpec.png"),specular:new e.p(4474026),normalScale:new e.Rb(6,6),shininess:.5}),n=new e.V(new e.Eb(15,40,40),a);t.add(n);var r=new e.gb;return v(r),t.add(r),{earth:n,pivot:r}}},288:function(t,s,a){},336:function(t,s,a){"use strict";a(288)},364:function(t,s,a){"use strict";a.r(s);var n=a(239),e=a(242),r=a(333),p=(a(286),a(253),a(334)),o=a(335),c=(a(287),a(285),a(244),a(241)),l={data:()=>({gui:null}),mounted(){this.init()},beforeDestroy(){this.gui&&this.gui.destroy()},methods:{init(){var t=document.getElementById("three1"),s=Object(c.f)(0,t),a=Object(c.e)(t,{antialias:!0}),l=Object(c.c)(t,new n.Sb(0,20,40)),v=new e.a(l,a.domElement);v.minDistance=5,v.maxDistance=4e3,v.target=new n.Sb(0,0,0);var i=new n.o,_=new n.xb,u=Object(c.a)(_),k=(u.earth,u.pivot,new o.a(_,l)),d=new p.a(.8,.325,256,!1);d.renderToScreen=!0;var m=new r.a(a);m.addPass(k),m.addPass(d),function t(){s.update();var a=i.getDelta();l.updateMatrixWorld(),requestAnimationFrame(t),m.render(a)}()}}},v=(a(336),a(14)),i=Object(v.a)(l,(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("设置"),s("code",[t._v("Three.js")]),t._v("库为后期处理做准备，我们需要通过以下步骤对当前的配置进行修改：")]),t._v(" "),s("ol",[s("li",[t._v("创建一个"),s("code",[t._v("EffectComposer")]),t._v("（效果组合器）对象，然后在该对象上添加后期处理通道。")]),t._v(" "),s("li",[t._v("配置该对象，使它可以渲染我们的场景，并应用额外的后期处理步骤。")]),t._v(" "),s("li",[t._v("在"),s("code",[t._v("render")]),t._v("循环中，使用"),s("code",[t._v("EffectComposer")]),t._v("渲染场景、应用通道、并输出结果。")])]),t._v(" "),s("h2",{attrs:{id:"创建effectcomposer对象"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建effectcomposer对象"}},[t._v("#")]),t._v(" 创建"),s("code",[t._v("EffectComposer")]),t._v("对象")]),t._v(" "),s("p",[t._v("我们先来看看需要包含的"),s("code",[t._v("JavaScript")]),t._v("文件。这些文件可以在"),s("code",[t._v("Three.js")]),t._v("的发布包里找到，路径是"),s("code",[t._v("examples/js/postprocessing")]),t._v("和"),s("code",[t._v("examples/js/shaders")]),t._v("。\n至少包含下面的文件：")]),t._v(" "),s("div",{staticClass:"language-html line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("text/javascript"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("../libs/postprogcessing/EffectComposer.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}}),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("text/javascript"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("../libs/postprogcessing/MaskPass.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}}),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("text/javascript"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("../libs/postprogcessing/RenderPass.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}}),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("text/javascript"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("../libs/shaders/CopyShader.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}}),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("text/javascript"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("../libs/postprogcessing/ShaderPass.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}}),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("ul",[s("li",[s("code",[t._v("EffectComposer.js")]),t._v("文件提供"),s("code",[t._v("EffectComposer")]),t._v("对象，以便添加后期处理步骤。")]),t._v(" "),s("li",[s("code",[t._v("MaskPass.js")]),t._v("、"),s("code",[t._v("ShaderPass.js")]),t._v("和"),s("code",[t._v("CopyShader.js")]),t._v("文件是"),s("code",[t._v("EffectComposer")]),t._v("内部使用的文件。")]),t._v(" "),s("li",[s("code",[t._v("RenderPass.js")]),t._v("文件则可以用来在"),s("code",[t._v("EffectComposer")]),t._v("对象上添加渲染通道。如果没有这些通道，我们的场景就不会被渲染。")])]),t._v(" "),s("p",[t._v("在这个示例里，我们添加了两个JavaScript文件，用来在场景中添加一种胶片效果：")]),t._v(" "),s("div",{staticClass:"language-html line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("text/javascript"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("../libs/postprocessing/FilmPass.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}}),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("text/javascript"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("../libs/shaders/FilmShader.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}}),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[t._v("首先我们要创建一个"),s("code",[t._v("EffectComposer")]),t._v("对象，你可以在这个对象的构造函数里传入"),s("code",[t._v("WebGLRenderer")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" composer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("THREE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EffectComposer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("webGLRenderer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("接下来我们要在这个组合器中添加各种通道。")]),t._v(" "),s("h2",{attrs:{id:"为后期处理配置effectcomposer对象"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#为后期处理配置effectcomposer对象"}},[t._v("#")]),t._v(" 为后期处理配置"),s("code",[t._v("EffectComposer")]),t._v("对象")]),t._v(" "),s("p",[t._v("每个通道会按照其加入"),s("code",[t._v("EffectComposer")]),t._v("的顺序执行。第一个要加入的通道是"),s("code",[t._v("RenderPass")]),t._v("。下面这个通道会渲染场景，但不会将渲染结果输出到屏幕上:")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" renderPass "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("THREE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RenderPass")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("scene"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("camera"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ncomposer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addPass")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("renderPass"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[t._v("创建"),s("code",[t._v("RenderPass")]),t._v("时要传入需要渲染的场景和所用的相机。调用"),s("code",[t._v("addPass()")]),t._v("函数，我们即可将这个"),s("code",[t._v("RenderPass")]),t._v("添加到"),s("code",[t._v("EffectComposer")]),t._v("对象中。接下来我们要添加一个可以将结果输出到屏幕的通道。不是所有的通道都可以做到这一点（稍后解释），但是本例中所用的"),s("code",[t._v("FilmPass")]),t._v("可以将其结果输出到屏幕。要添加"),s("code",[t._v("FilmPass")]),t._v("，我们先要创建该对象，然后添加效果到组合器中。最终的代码大致如下：")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" renderPass "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("THREE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RenderPass")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("scene"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("camera"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" effectFilm "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("THREE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FilmPass")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.325")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("256")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\neffectFilm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("renderToScreen "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" composer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("THREE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EffectComposer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("webGLRenderer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ncomposer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addPass")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("renderPass"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ncomposer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addPass")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("effectFilm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br")])]),s("p",[t._v("正如你所看到的，我们创建了一个FilmPass对象，并将他的"),s("code",[t._v("renderToScreen")]),t._v("属性设为"),s("code",[t._v("true")]),t._v("。这个通道是在"),s("code",[t._v("RenderPass")]),t._v("后面添加的，所以如果使用了这个效果组合器，我们就可以看到输入结果。")]),t._v(" "),s("h2",{attrs:{id:"修改渲染循环"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#修改渲染循环"}},[t._v("#")]),t._v(" 修改渲染循环")]),t._v(" "),s("p",[t._v("现在我们需要稍稍修改一下这个渲染循环，用效果组合器来取代"),s("code",[t._v("WebGLRender")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" clock "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("THREE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Clock")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    stats"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" delta "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" clock"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getDelta")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    orbitControls"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("delta"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    sphere"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rotation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("y "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.002")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("requestAnimationFrame")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("render"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    composer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("delta"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br")])]),s("p",[t._v("这段代码里我们移除了"),s("code",[t._v("webGLRenderer.render(scene,camera)")]),t._v(",用"),s("code",[t._v("composer.render(delta)")]),t._v("替代。这将调用"),s("code",[t._v("EffectComposer")]),t._v("的"),s("code",[t._v("render()")]),t._v("函数。由于我们已经将"),s("code",[t._v("FilmPass")]),t._v("的"),s("code",[t._v("renderToScreen")]),t._v("属性设置成"),s("code",[t._v("true")]),t._v("，所以"),s("code",[t._v("FilmPass")]),t._v("的结果将会输出到屏幕上。")]),t._v(" "),[s("div",{attrs:{id:"three1"}})]],2)}),[],!1,null,"2324658c",null);s.default=i.exports}}]);